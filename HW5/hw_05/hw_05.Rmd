---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "مهبد مجید ۹۵۱۰۹۳۷۲"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

```{r preprocess, message=FALSE, warning=FALSE, code=readLines("./solutions/preprocess.R"), include=FALSE, paged.print=FALSE}
```

***

<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>

<p dir="RTL">
برای این سوال از تست
`chi-squared`
استفاده می کنیم.
دلیل این کارمان هم این است که ما در اصل می خواهیم ببینیم آیا احتمال خرید کردن افراد از هرکدام از این نمایندگی ها برابر است یا خیر.
</br>
به  عبارتی:
</p>

$$H_0: P_1=P_2=P_3=P_4=P_5=P_6=P_7=P_8 = \frac{1}{8}$$

```{r 1, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/1.R"), paged.print=FALSE}
```

<p dir="RTL">
همانطور که می بینید `pvalue`
کمتر از
$0.05$
شد پس فرض صفر را که برابری احتمال خرید کردن از هرکدام از این فروشگاه هاست را رد می کنیم.
</p>

***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>

<p dir = "RTL">
از آنجایی که روی داده ها هیچ فرضی مثل نرمال بودن
و ... نداریم برای
مقایسه ی عملکرد
باید از یکی از تست های جایگشت استفاده کنیم.
همچنین از آنجایی که 
`Wilcoxon`
باعث می شود تاثیر داده های خیلی بزرگ یا خیلی کوچک کمتر بشود از این 
تست
استفاده می کنیم.
</p>

```{r 2, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/2.R"), paged.print=FALSE}
```

<p dir = "RTL">
همانطور که مشاهده می کنید 
`pvalue`
از 
$0.05$
کمتر نشد.
پس نمی توان فرض صفر یعنی عدم وجود تفاوت میان ۲ دسته را رد کرد.
به عبارت دیگر الزاما نمی توان گفت که تفاوتی در عملکرد میان این ۲ نوع شعبه وجود دارد.
</p>

***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>

<p dir = "RTL">
مشابه قسمت قبلی می خواهیم عملکرد را در ۲ دسته مقایسه کنیم،
با این تفاوت که داده ها جفت جفت هستند.
پس یاید از
`paired wilcoxon test`
استفاده کنیم.
</p>

```{r 3, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/3.R"), paged.print=FALSE}
```

<p dir = "RTL">
همانطور که مشاهده می کنید 
`pvalue`
از 
$0.05$
کمتر نشد.
پس نمی توان فرض صفر یعنی بدتر شدن
(مخالف بهتر شدن)
عملکرد را رد کرد.
به عبارت دیگر الزاما عملکرد فروش بالاتر نرفته.
</p>

***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>

<p dir = "RTL">
برای این سوال از تست 
`Kruskal-Wallis`
استفاده می کنیم.
از این تست برای بررسی یکسان بودن توزیع ها در جمعیت ها استففاده می شود.
</p>

```{r 4, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/4.R"), paged.print=FALSE}
```

<p dir = "RTL">
همانطور که مشاهده می کنید 
`pvalue`
از 
$0.05$
کمتر نشد.
پس نمی توان فرض صفر یعنی
بی تاثیر بودن رنگ در فروش را رد کرد.
به عبارت دیگر نمی توان گفت که رنگ در فروش موثر است.
</p>

***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>

<p dir="RTL">
در این مسئله می خواهیم ببینیم که آیا تغییری در میزان رضایت رخ داده است یا نه.
یا به عبارتی می خواهیم ببینیم آیا سطح 
رضایت در چند دسته ی 
وابسته به هم یکسان است یا نه.
برای این کار از تست
`Friedman`
استفاده می کنیم.
</p>


```{r 5, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/5.R"), paged.print=FALSE}
```

<p dir = "RTL">
همانطور که مشاهده می کنید 
`pvalue`
از 
$0.05$
کمتر نشد.
پس نمی توان فرض صفر یعنی
عدم تغییرات در سطح رضایت را رد کرد.
به عبارت دیگر نمی توان گفت که تغییری در سطح رضایت رخ داده است.
</p>

***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |

<p dir="RTL">
فرض صفرمان را این می گذاریم که داده ها در
هر کدام از قسمت های 
`Small`
،
`Medium`
و
`Large`
از یک توزیع آمده باشند.
برای بررسی این نکته از
`chi-squared test`
استفاده می کنیم.
</p>

```{r 6, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/6.R"), paged.print=FALSE}
```

<p dir="RTL">
همانطور که می بینید `pvalue`
کمتر از
$0.05$
شد.
پس فرض صفر یعنی یکسان بودن توزیع نظرات در شهرهایی با اندازه های متفاوت رد می شود.
یعنی اندازه ی شهر در نظر مردم تاثیر دارد.
</p>

***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

<p dir="RTL"> 
برای بررسی وجود ربط معنادار میان فروش این دو محصول ضریب همبستگی را محاسبه می کنیم.
و برای محاسبه ی آن هم از روش
`Spearman`
که در مقایسه با روش
`Pearson`
بهتر است استفاده می کنیم زیرا در این روش نسبت به نحوه ی صعود و نزول وابستگی کمتری دارد.
</p>

```{r 7, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/7.R"), paged.print=FALSE}
```

<p dir="RTL"> 
همانطور که مشاهده می کنید 
`cor`
با صفر فاصله ی چندانی ندارد.
همچنین
همانطور که مشاهده می کنید 
`pvalue`
از 
$0.05$
کمتر نشد.
پس نمی توان فرض صفر یعنی
صفر بودن 
`correlation`
را رد کرد.
به عبارت دیگر نمی توان گفت که ارتباط معناداری میان فروش این ۲ محصول وجود دارد.
</p>
***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>

<p dir="RTL"> 
برای حل این مسئله باید بررسی کنیم که آیا توزیع جنسیت ها در ۳ ردیف
`Price`
،
`Design`
و
`Color`
یکسان است یا خیر.
برای بررسی این نکته از
`chi-squared test`
استفاده می کنیم.
</p>

```{r 8, echo=TRUE, message=FALSE, warning=FALSE, code=readLines("./solutions/8.R"), paged.print=FALSE}
```

<p dir="RTL"> 
همانطور که می بینید `pvalue`
کمتر از
$0.05$
شد.
پس فرض صفر یعنی بی تاثیر بودن جنسیت در مشخصه کاربری کالا رد می شود.
یعنی جنسیت در مشخصه کاربری کالا موثر است.
</p>